<!DOCTYPE html>
<html lang="ja">
<head>
	<meta charset="UTF-8">
	<title>Sophia v1.7.2 Runtime UI</title>
	<style>
		:root {
			--bg: #050505; --panel: #111; --border: #333;
			--text: #d1d5db; --accent: #00d4ff; --log-sys: #3b82f6;
			--log-gbl: #10b981; --log-err: #ef4444;
		}
		body {
			font-family: 'Fira Code', monospace;
			background-color: var(--bg); color: var(--text);
			margin: 0; display: flex; flex-direction: column; height: 100vh;
		}
		header { background: var(--panel); border-bottom: 2px solid var(--accent); padding: 10px 20px; }
		main { display: flex; flex: 1; overflow: hidden; }
		#editor-section { flex: 1; display: flex; flex-direction: column; border-right: 1px solid var(--border); }
		textarea { flex: 1; background: #000; color: #a5f3fc; border: none; padding: 15px; font-size: 14px; }
		.toolbar { background: var(--panel); padding: 8px 15px; }
		button { background: var(--accent); border: none; color: #000; padding: 5px 15px; font-weight: bold; cursor: pointer; }
		#console { height: 250px; overflow-y: auto; padding: 15px; background: #000; font-size: 13px; }
		.log-entry { margin-bottom: 4px; padding-left: 8px; border-left: 3px solid #444; }
		.type-system { border-color: var(--log-sys); }
	</style>
</head>
<body>

<header>
	<h1>Sophia <span style="color:var(--accent)">v1.7.2</span> RUNTIME</h1>
</header>

<main>
	<div id="editor-section">
		<div class="toolbar">
			<button onclick="runSophia()">COMPILE & EXECUTE</button>
		</div>
		<textarea id="sophia-input" spellcheck="false">
(* Sophia v1.7.2 Test Script *)
#unit [ id:u32, hp:i16 ]

scene Main |> [
	~hp [ < 100 ]
	? [ ~hp gt 0 ] [
		$log [ "Sophia is active." ]
	]
]
		</textarea>
		<div id="console"></div>
	</div>
</main>

<script src="sophia_core.js"></script>

<script src="sophia_pool.js"></script>
<script src="sophia_bridge.js"></script>
<script src="sophia_lexer.js"></script>

<script src="sophia_parser.js"></script>

<script src="sophia_transpiler.js"></script>

<script src="sophia_flow.js"></script>
<script src="sophia_bootstrap.js"></script>

<script>
	// UI ロギングの接続
	(function(app){
		var consoleEl = document.getElementById("console");
		app.Runtime.log = function(msg, type) {
			var div = document.createElement("div");
			div.className = "log-entry " + (type || "");
			var timeInfo = app.Runtime.elapsedTime.toFixed(2) + "s";
			div.innerHTML = "<span style='color:#666; font-size:10px;'>[" + timeInfo + "]</span> " + msg;
			consoleEl.appendChild(div);
			consoleEl.scrollTop = consoleEl.scrollHeight;
		};
	})(SOPHIA);

	function runSophia() {
		var source = document.getElementById("sophia-input").value;
		SOPHIA.Main.loadScript(source);
	}

	window.onload = function() {
		SOPHIA.Main.init();
	};
</script>

</body>
</html>